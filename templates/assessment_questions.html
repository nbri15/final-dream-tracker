{% extends "layout.html" %}
{% block title %}Questions — {{ assessment.title }}{% endblock %}
{% block content %}
<h1>Questions — {{ assessment.title }}</h1>
<p>Class: {{ assessment.klass.name }} | Year: {{ assessment.academic_year.label }} | Term: {{ assessment.term }} | Subject: {{ assessment.subject|upper }} | Paper: {{ assessment.paper }}</p>

<form method="post">
  <table class="table-sticky sortable">
    <thead><tr><th class="sortable" data-sort="number">#</th><th class="sortable" data-sort="number">Max mark</th><th class="sortable" data-sort="text">Question type</th><th class="sortable" data-sort="text">Strand</th><th class="sortable" data-sort="text">Notes</th></tr></thead>
    <tbody id="qbody">
      {% for q in questions %}
        <tr>
          <td><input type="number" name="qn[]" value="{{ q.number }}" min="1" required></td>
          <td><input type="number" step="0.1" name="max[]" value="{{ q.max_mark }}" min="0.1" required></td>
          <td><input type="text" name="qtype[]" value="{{ q.question_type or '' }}"></td>
          <td><input type="text" name="strand[]" value="{{ q.strand or '' }}"></td>
          <td><input type="text" name="notes[]" value="{{ q.notes or '' }}"></td>
        </tr>
      {% endfor %}
    </tbody>
  </table>
  <p>
    <button class="button" type="button" onclick="addRow()">+ Add question</button>
    <button class="button" type="submit">Save questions</button>
  </p>
</form>

<script>
function addRow() {
  const tbody = document.getElementById('qbody');
  const row = document.createElement('tr');
  row.innerHTML = `
    <td><input type="number" name="qn[]" min="1" required></td>
    <td><input type="number" step="0.1" name="max[]" value="1.0" min="0.1" required></td>
    <td><input type="text" name="qtype[]" value=""></td>
    <td><input type="text" name="strand[]" value=""></td>
    <td><input type="text" name="notes[]" value=""></td>`;
  tbody.appendChild(row);
}
</script>
{% endblock %}
